@startuml
title Sistema Integral de Gestión de Negocios

' =============================
' CLASES PRINCIPALES
' =============================

class Usuario {
  +id: ObjectId
  +nombre: string
  +email: string
  +password: string
  +rol: string
  --
  +login()
  +logout()
  +registrar()
}

class Categoria {
  +id: ObjectId
  +nombre: string
  +descripcion: string
  --
  +agregarProducto()
  +listarProductos()
}

class Producto {
  +id: ObjectId
  +nombre: string
  +precio: float
  +stock: int
  +categoria: Categoria
  --
  +actualizarStock()
}

class Venta {
  +id: ObjectId
  +fecha: Date
  +total: float
  +usuario: Usuario
  --
  +registrarVenta()
  +calcularTotal()
}

class DetalleVenta {
  +producto: Producto
  +cantidad: int
  +subtotal: float
}

' =============================
' RELACIONES PRINCIPALES
' =============================
Usuario "1" -- "*" Venta
Venta "1" -- "*" DetalleVenta
Producto "1" -- "*" DetalleVenta
Categoria "1" -- "*" Producto

' =============================
' SINGLETON
' =============================
class ConexionDB {
  -instancia: ConexionDB
  --
  +getInstancia(): ConexionDB
  +conectar()
  +desconectar()
}
note right of ConexionDB
  Patrón: Singleton
  Asegura una única instancia global
end note

' =============================
' FACADE
' =============================
class FacadeReportes {
  +generarReporteVentas()
  +generarGraficoStock()
  +exportarPDF()
}
FacadeReportes ..> ConexionDB : usa >
FacadeReportes ..> Venta
FacadeReportes ..> Producto
note right of FacadeReportes
  Patrón: Facade
  Simplifica operaciones de reportes y dashboard
end note

' =============================
' STRATEGY
' =============================
interface EstrategiaAutenticacion {
  +autenticar(usuario: Usuario): bool
}

class AuthLocal
class AuthGoogle

EstrategiaAutenticacion <|.. AuthLocal
EstrategiaAutenticacion <|.. AuthGoogle
Usuario ..> EstrategiaAutenticacion : usa >

note right of EstrategiaAutenticacion
  Patrón: Strategy
  Permite intercambiar métodos de autenticación
end note

' =============================
' OBSERVER
' =============================
interface ObservadorDashboard {
  +actualizar()
}

class Sujeto {
  +agregarObservador(obs: ObservadorDashboard)
  +notificar()
}

class Dashboard {
  +estadisticas: dict
  --
  +mostrarActualizacion()
}

Sujeto o-- "1..*" ObservadorDashboard
Dashboard ..|> ObservadorDashboard
Sujeto --> Dashboard : notifica >

note right of Sujeto
  Patrón: Observer
  Dashboard se actualiza ante cambios en ventas o stock
end note

@enduml
